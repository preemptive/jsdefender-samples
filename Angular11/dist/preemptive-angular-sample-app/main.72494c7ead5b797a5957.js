(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,r){t.exports=r("zUnb")},D7ij:function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"e",function(){return o}),r.d(e,"c",function(){return s}),r.d(e,"b",function(){return a}),r.d(e,"d",function(){return c});var n=function(t){return t.LOGIN="[Auth] Login",t.LOGIN_SUCCESS="[Auth] Login Success",t.LOGIN_FAILURE="[Auth] Login Failure",t.LOGOUT="[Auth] Logout",t.GET_USER="[Auth] GetUser",t}({});class o{constructor(t){this.payload=t,this.type=n.LOGIN}}class s{constructor(t){this.payload=t,this.type=n.LOGIN_SUCCESS}}class a{constructor(t){this.payload=t,this.type=n.LOGIN_FAILURE}}class c{constructor(){this.type=n.LOGOUT}}},lGQG:function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r("fXoL"),o=r("tk/3"),s=r("tyNb");let a=(()=>{class t{constructor(t,e){this.http=t,this.router=e}getToken(){return localStorage.getItem("token")}logIn(t,e){return this.http.get(`https://swapi.dev/api/people/?search=${t}`)}getUser(){return this.http.get("https://swapi.dev/api/planets/?page=1")}}return t.\u0275fac=function(e){return new(e||t)(n.Qb(o.b),n.Qb(s.a))},t.\u0275prov=n.Gb({token:t,factory:t.\u0275fac}),t})()},mOc2:function(t,e,r){"use strict";r.d(e,"a",function(){return a}),r.d(e,"b",function(){return c});var n=r("l7P3"),o=r("D7ij");const s={isAuthenticated:!1,user:null,errorMessage:null},a={auth:function(t=s,e){switch(e.type){case o.a.LOGIN_SUCCESS:return Object.assign(Object.assign({},t),{isAuthenticated:!0,user:{token:e.payload.token,username:e.payload.username},errorMessage:null});case o.a.LOGIN_FAILURE:return Object.assign(Object.assign({},t),{errorMessage:"DOB does not match"});case o.a.LOGOUT:return s;default:return t}}},c=Object(n.h)("auth")},zUnb:function(t,e,r){"use strict";r.r(e);var n=r("jhN1"),o=r("fXoL"),s=r("3Pt+"),a=r("tk/3"),c=r("9jGm"),i=r("l7P3"),u=r("tyNb");let p=(()=>{class t{constructor(){this.title="preemptive-angular-sample-app"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Eb({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&o.Lb(0,"router-outlet")},directives:[u.c],styles:[""]}),t})();var h=r("lGQG"),l=r("mrSG"),b=r("LRne"),d=r("JIr8"),f=r("eIep"),O=r("lJxs"),g=r("vkgz"),j=r("D7ij");let v=(()=>{class t{constructor(t,e,r){this.actions=t,this.authService=e,this.router=r,this.GetUser=this.actions.pipe(Object(c.d)(j.a.GET_USER)).pipe(Object(f.a)(t=>this.authService.getUser())),this.Login=this.actions.pipe(Object(c.d)(j.a.LOGIN)).pipe(Object(O.a)(t=>t.payload)).pipe(Object(f.a)(t=>this.authService.logIn(t.username,t.dob).pipe(Object(O.a)(e=>{let r=e.results.length;if(!(e.count>0))return new j.b({error:"Username and DOB does not exist"});for(let n=0;n<r;n++)if(e.results[n].name===t.username)return e.results[n].birth_year===t.dob?new j.c({token:e.token,username:t.username}):new j.b({error:"Username does not exist"})})).pipe(Object(d.a)(t=>Object(b.a)(new j.b({error:t})))))),this.LogInSuccess=this.actions.pipe(Object(c.d)(j.a.LOGIN_SUCCESS),Object(g.a)(t=>{this.router.navigateByUrl("/home")})),this.LogInFailure=this.actions.pipe(Object(c.d)(j.a.LOGIN_FAILURE)),this.LogOut=this.actions.pipe(Object(c.d)(j.a.LOGOUT),Object(g.a)(t=>{this.router.navigateByUrl("/")}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(c.a),o.Qb(h.a),o.Qb(u.a))},t.\u0275prov=o.Gb({token:t,factory:t.\u0275fac}),Object(l.a)([Object(c.b)({dispatch:!1})],t.prototype,"GetUser",void 0),Object(l.a)([Object(c.b)()],t.prototype,"Login",void 0),Object(l.a)([Object(c.b)({dispatch:!1})],t.prototype,"LogInSuccess",void 0),Object(l.a)([Object(c.b)({dispatch:!1})],t.prototype,"LogInFailure",void 0),Object(l.a)([Object(c.b)({dispatch:!1})],t.prototype,"LogOut",void 0),t})();var L=r("mOc2");const y=[{path:"home",loadChildren:()=>r.e(5).then(r.bind(null,"ct+p")).then(t=>t.HomeModule)},{path:"",loadChildren:()=>r.e(6).then(r.bind(null,"X3zk")).then(t=>t.LoginModule)}];let G=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Ib({type:t}),t.\u0275inj=o.Hb({imports:[[u.b.forRoot(y)],u.b]}),t})(),m=(()=>{class t{constructor(t){this.injector=t}intercept(t,e){this.authService=this.injector.get(h.a);const r=this.authService.getToken();return t=t.clone({setHeaders:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}}),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(o.s))},t.\u0275prov=o.Gb({token:t,factory:t.\u0275fac}),t})(),U=(()=>{class t{constructor(t){this.router=t}intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(u.a))},t.\u0275prov=o.Gb({token:t,factory:t.\u0275fac}),t})(),I=(()=>{class t{constructor(t,e){this.auth=t,this.router=e}canActivate(){return!!this.auth.getToken()||(this.router.navigateByUrl("/"),!1)}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(h.a),o.Qb(u.a))},t.\u0275prov=o.Gb({token:t,factory:t.\u0275fac}),t})();var S=r("ofXK");let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Ib({type:t,bootstrap:[p]}),t.\u0275inj=o.Hb({providers:[h.a,I,{provide:a.a,useClass:m,multi:!0},{provide:a.a,useClass:U,multi:!0}],imports:[[S.b,n.a,s.b,a.c,G,i.d.forRoot(L.a,{}),c.c.forRoot([v])]]}),t})();Object(o.T)(),n.b().bootstrapModule(w).catch(t=>console.error(t))},zn8P:function(t,e){function r(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id="zn8P"}},[[0,0,4]]]);